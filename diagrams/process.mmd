flowchart LR

  %% nodes
  ds["7 Source Datasets<br>(AquaMaps, NMFS Core,<br>NMFS CH, FWS CH,<br>FWS Range, BirdLife,<br>IUCN Range)"]:::in
  ta[("Taxonomic<br>Authorities<br>(WoRMS, GBIF,<br>ITIS, IUCN,<br>BirdLife)")]:::in
  er[["Extinction Risk<br>Scores<br>(ESA, MMPA,<br>MBTA, IUCN)"]]:::in
  pp[["Primary<br>Productivity<br>(VGPM)"]]:::in

  m[/"Match<br>Taxa"/]:::fxn
  mg[/"Merge<br>Models<br>(MAX + mask<br>+ spatial floors)"/]:::fxn
  sc[/"Score<br>Cells<br>(ER × presence<br>by category)"/]:::fxn
  rs[/"Rescale<br>Ecoregional<br>[0-100%]"/]:::fxn
  za[/"Aggregate<br>Zones"/]:::fxn

  tx("9,819 Valid<br>Species<br>(is_ok=TRUE)"):::out
  mm("Merged<br>Models<br>(0.05° grid)"):::out
  cm("Cell<br>Metrics"):::out
  zm("Zone<br>Scores<br>(program areas,<br>subregions,<br>ecoregions)"):::out
  viz("Visualization<br>(Flower Plot,<br>Treemap,<br>Interactive Maps)"):::out

  %% edges
  ds   --> m
  ta   --> m
  m    --> tx
  tx   --> mg
  ds   --> mg
  mg   --> mm
  mm   --> sc
  er   --> sc
  pp   --> sc
  sc   --> cm
  cm   --> rs
  rs   --> za
  za   --> zm
  zm   --> viz

  %% Legend
  in(input):::in
  fxn[/process/]:::fxn
  out(output):::out
  subgraph Legend
    in
    fxn
    out
  end

  %% styles
  classDef in  fill:lightblue
  classDef out fill:lightgreen
  classDef fxn fill:yellow
